import{w as X,v as B,r as m,y as Z,z as ee,q as te,j as e,S as D,T as h,A as E,C as g,B as j,M as b,D as f,L as re,E as ae,F as k,W as se}from"./index-8ec84c2e.js";import{v as ne}from"./index-1e72cb9d.js";import{C as le}from"./index-64421431.js";import{U as M}from"./upload-file-icon-29fb1eae.js";import{C as oe}from"./Container-9125bcc9.js";import{C as ie}from"./Card-9ed39c6a.js";import{G as s,L as O,A as F,D as N}from"./useMobilePicker-86261c4e.js";import{T as o}from"./TextField-8c4afb1f.js";import{S as Q}from"./Select-1317b73c.js";import{D as A}from"./DatePicker-12fb01a2.js";import"./isMuiElement-60f8c955.js";function de(){const v=X(),L=B(t=>t.user.token),I=B(t=>t.user.user);m.useEffect(()=>{I&&I.role!=="HR"&&v.push("/404")},[I,v]);const{data:u,error:y}=Z({token:L}),[T,{isLoading:_,data:U,error:x}]=ee(),z=m.useRef(),i=te(),[r,w]=m.useState({employeeId:"",firstName:"",lastName:"",gender:"Male",email:"",phone:"",whatsApp:"",dob:"",local:"",city:"",state:"",pincode:"",commLocal:"",commCity:"",commPincode:"",commState:"",role:"",departmentId:"",salary:"",hike:""}),l=(t,n)=>{w({...r,[t]:n})},[R,$]=m.useState(null),[d,P]=m.useState({id:"",doc:null,expiryDate:""}),[c,W]=m.useState({id:"",doc:null,expiryDate:""}),Y={open:!1,mssg:"",bgColor:i.palette.error.dark,anchorOrigin:{vertical:"top",horizontal:"right"}},[C,p]=m.useState(Y),q=()=>{z.current.click()},H=t=>{const n=t.target.files[0];n&&$(n)},V=()=>{const t=new FormData;let n=!0;if(Object.keys(r).forEach(a=>{if(r[a]===""){n=!1;return}if(a==="email"){if(!ne.isEmail(r[a])){n=!1;return}t.append(a,r[a])}else if(a==="dob"){const S=k(new Date(r[a]),"dd/MM/yyyy");t.append(a,S)}else if(a==="departmentId"){const S=r[a].split("^")[0];t.append(a,S)}else t.append(a,r[a])}),!n){p({open:!0,mssg:"All fields are mandatory",bgColor:i.palette.error.dark,anchorOrigin:{vertical:"top",horizontal:"right"}});return}if(t.append("profilePicture",R),!d.doc||!c.doc){p({open:!0,mssg:"Qatar/Passport Image is missing",bgColor:i.palette.error.dark,anchorOrigin:{vertical:"top",horizontal:"right"}});return}if(d.id===""||d.expiryDate===""){p({open:!0,mssg:"Qatar ID details missing",bgColor:i.palette.error.dark,anchorOrigin:{vertical:"top",horizontal:"right"}});return}if(c.id===""||c.expiryDate===""){p({open:!0,mssg:"Qatar ID details missing",bgColor:i.palette.error.dark,anchorOrigin:{vertical:"top",horizontal:"right"}});return}t.append("qatarDoc",d.doc),t.append("passportDoc",c.doc),t.append("qatarExpiryDate",k(new Date(d.expiryDate),"dd/MM/yyyy")),t.append("passportExpiryDate",k(new Date(c.expiryDate),"dd/MM/yyyy")),t.append("qatarID",d.id),t.append("passportID",c.id),T({body:t,token:L})},G=e.jsxs(e.Fragment,{children:[e.jsx(f,{variant:"contained",color:"primary",onClick:q,startIcon:e.jsx(M,{}),sx:{width:"150px",marginLeft:"25px"},children:"Upload Pic"}),e.jsx("input",{ref:z,type:"file",style:{display:"none"},onChange:H})]}),J=t=>{const n=t.target.files[0];if(n){const a=n.name.toLowerCase();!a.endsWith(".jpg")&&!a.endsWith(".jpeg")&&!a.endsWith(".png")?p({open:!0,mssg:"Only jpg/jpeg/png file is allowed!",bgColor:i.palette.error.dark,anchorOrigin:{vertical:"top",horizontal:"right"}}):P({...d,doc:n})}},K=t=>{const n=t.target.files[0];if(n){const a=n.name.toLowerCase();!a.endsWith(".jpg")&&!a.endsWith(".jpeg")&&!a.endsWith(".png")?p({open:!0,mssg:"Only jpg/jpeg/png file is allowed!",bgColor:i.palette.error.dark,anchorOrigin:{vertical:"top",horizontal:"right"}}):W({...c,doc:n})}};return m.useEffect(()=>{if(y){let t="";y.status==="FETCH_ERROR"?t="Server is not responding!":t=y.data.error,p({open:!0,mssg:t,bgColor:i.palette.error.dark,anchorOrigin:{vertical:"top",horizontal:"right"}})}if(u)if(u.departments.length>0){const{_id:t,name:n}=u.departments[0];t&&n&&w(a=>({...a,departmentId:`${t}^${n}`}))}else w(t=>({...t,departmentId:""})),p({open:!0,mssg:"Warning! No department found",bgColor:i.palette.error.dark,anchorOrigin:{vertical:"top",horizontal:"right"}})},[y,u,i]),m.useEffect(()=>{if(x){let t="";x.status==="FETCH_ERROR"?t="Server is not responding!":t=x.data.error,p({open:!0,mssg:t,bgColor:i.palette.error.dark,anchorOrigin:{vertical:"top",horizontal:"right"}}),console.error(x)}U&&v.push("/user")},[x,U,v,i]),e.jsxs(oe,{children:[e.jsx(le,{open:C.open,mssg:C.mssg,bgColor:C.bgColor,closeSnackbar:()=>{p(Y)},severity:"error",anchorOrigin:C.anchorOrigin}),e.jsx(D,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:e.jsx(h,{variant:"h4",children:"New User"})}),e.jsxs(D,{direction:"column",gap:"20px",width:"250px",alignItems:"flex-start",children:[e.jsx(E,{sx:{height:"200px",width:"200px"},src:g(R)}),G]}),e.jsxs(ie,{sx:{padding:"30px",display:"flex",flexDirection:"column",gap:"50px",marginTop:"50px"},children:[e.jsxs(j,{children:[e.jsx(h,{gutterBottom:!0,variant:"h5",color:i.palette.grey[500],children:"Personal Information"}),e.jsxs(s,{container:!0,spacing:2,alignItems:"stretch",children:[e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(o,{fullWidth:!0,placeholder:"Employee ID",value:r.employeeId,onChange:t=>{l("employeeId",t.target.value)}})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(o,{fullWidth:!0,placeholder:"First Name",value:r.firstName,onChange:t=>{l("firstName",t.target.value)}})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(o,{fullWidth:!0,placeholder:"Last Name",value:r.lastName,onChange:t=>{l("lastName",t.target.value)}})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsxs(Q,{fullWidth:!0,label:"Gender",value:r.gender,onChange:t=>{l("gender",t.target.value)},children:[e.jsx(b,{value:"Male",children:"Male"}),e.jsx(b,{value:"Female",children:"Female"})]})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(o,{fullWidth:!0,placeholder:"Email",type:"email",value:r.email,onChange:t=>{l("email",t.target.value)}})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(o,{fullWidth:!0,placeholder:"Phone",type:"number",value:r.phone,onChange:t=>{l("phone",t.target.value)}})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(o,{fullWidth:!0,placeholder:"WhatsApp",type:"number",value:r.whatsApp,onChange:t=>{l("whatsApp",t.target.value)}})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(O,{dateAdapter:F,children:e.jsx(N,{components:["DatePicker"],children:e.jsx(A,{format:"DD/MM/YYYY",label:"Date Of Birth",disableFuture:!0,sx:{width:"100%"},value:r.dob===""?null:r.dob,onChange:t=>{l("dob",t)}})})})})]})]}),e.jsxs(j,{children:[e.jsx(h,{gutterBottom:!0,variant:"h5",color:i.palette.grey[500],children:"Homeland Address"}),e.jsxs(s,{container:!0,spacing:2,alignItems:"stretch",children:[e.jsx(s,{item:!0,xs:8,children:e.jsx(o,{fullWidth:!0,placeholder:"Enter your homeland address",value:r.local,onChange:t=>{l("local",t.target.value)}})}),e.jsx(s,{item:!0,xs:4,children:e.jsx(o,{fullWidth:!0,placeholder:"Pin code",type:"number",value:r.pincode,onChange:t=>{l("pincode",t.target.value)}})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(o,{fullWidth:!0,placeholder:"City",value:r.city,onChange:t=>{l("city",t.target.value)}})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(o,{fullWidth:!0,placeholder:"State",value:r.state,onChange:t=>{l("state",t.target.value)}})})]})]}),e.jsxs(j,{children:[e.jsx(h,{gutterBottom:!0,variant:"h5",color:i.palette.grey[500],children:"Communication Address"}),e.jsxs(s,{container:!0,spacing:2,alignItems:"stretch",children:[e.jsx(s,{item:!0,xs:8,children:e.jsx(o,{fullWidth:!0,placeholder:"Enter your communication address",value:r.commLocal,onChange:t=>{l("commLocal",t.target.value)}})}),e.jsx(s,{item:!0,xs:4,children:e.jsx(o,{fullWidth:!0,placeholder:"Pin code",type:"number",value:r.commPincode,onChange:t=>{l("commPincode",t.target.value)}})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(o,{fullWidth:!0,placeholder:"City",value:r.commCity,onChange:t=>{l("commCity",t.target.value)}})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(o,{fullWidth:!0,placeholder:"State",value:r.commState,onChange:t=>{l("commState",t.target.value)}})})]})]}),e.jsxs(j,{children:[e.jsx(h,{gutterBottom:!0,variant:"h5",color:i.palette.grey[500],children:"Legal Documents"}),e.jsxs(D,{direction:{xs:"column",md:"row"},gap:{xs:"10px",md:"40px"},mt:{xs:"50px",md:"30px"},alignItems:"center",children:[e.jsx(E,{src:g(d.doc),alt:d.doc?d.doc.name:"Qatar Document",children:"Q"}),e.jsx(o,{type:"text",placeholder:"Qatar ID Number",value:d.id,onChange:t=>P({...d,id:t.target.value})}),e.jsxs(f,{component:"label",variant:"contained",tabIndex:-1,startIcon:e.jsx(M,{}),children:["Upload Image",e.jsx("input",{type:"file",onChange:J,style:{display:"none"}})]}),e.jsx(O,{dateAdapter:F,children:e.jsx(N,{components:["DatePicker"],sx:{padding:0},children:e.jsx(A,{format:"DD/MM/YYYY",label:"Expiry Date",disablePast:!0,sx:{width:"100%"},value:d.expiryDate===""?null:d.expiryDate,onChange:t=>P({...d,expiryDate:t})})})}),e.jsx(f,{onClick:()=>window.open(g(d.doc),"_blank"),children:"View"})]}),e.jsxs(D,{direction:{xs:"column",md:"row"},gap:{xs:"10px",md:"40px"},mt:{xs:"50px",md:"30px"},alignItems:"center",children:[e.jsx(E,{src:g(c.doc),alt:c.doc?c.doc.name:"Passport Document",children:"P"}),e.jsx(o,{type:"text",placeholder:"Passport ID Number",value:c.id,onChange:t=>W({...c,id:t.target.value})}),e.jsxs(f,{component:"label",variant:"contained",tabIndex:-1,startIcon:e.jsx(M,{}),children:["Upload Image",e.jsx("input",{type:"file",onChange:K,style:{display:"none"}})]}),e.jsx(O,{dateAdapter:F,children:e.jsx(N,{components:["DatePicker"],sx:{padding:0},children:e.jsx(A,{format:"DD/MM/YYYY",label:"Expiry Date",disablePast:!0,sx:{width:"100%"},value:c.expiryDate===""?null:c.expiryDate,onChange:t=>W({...c,expiryDate:t})})})}),e.jsx(f,{onClick:()=>window.open(g(c.doc),"_blank"),children:"View"})]})]}),e.jsxs(j,{children:[e.jsx(h,{gutterBottom:!0,variant:"h5",color:i.palette.grey[500],children:"Other Information"}),e.jsxs(s,{container:!0,spacing:2,alignItems:"stretch",children:[e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(o,{fullWidth:!0,placeholder:"Employee Role",value:r.role,onChange:t=>{l("role",t.target.value)}})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(Q,{fullWidth:!0,label:"Department",value:r.departmentId,onChange:t=>{const[n,a]=t.target.value.split("^");l("departmentId",`${n}^${a}`)},children:!u||u.departments.length===0?e.jsx(b,{value:"",children:" "}):u.departments.map(t=>e.jsx(b,{value:`${t._id}^${t.name}`,children:t.name}))})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(o,{fullWidth:!0,placeholder:"Base Salary (per month)",type:"number",value:r.salary,onChange:t=>{l("salary",t.target.value)}})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(o,{fullWidth:!0,placeholder:"Salry Hike (yearly in %)",type:"number",value:r.hike,onChange:t=>{l("hike",t.target.value)}})})]})]}),e.jsx(re,{loading:_,loadingIndicator:e.jsx(ae,{}),variant:"contained",sx:{alignSelf:"flex-start"},onClick:V,children:"Save"})]})]})}function Ce(){return e.jsxs(e.Fragment,{children:[e.jsx(se,{children:e.jsx("title",{children:" New User | Employee Management System "})}),e.jsx(de,{})]})}export{Ce as default};
